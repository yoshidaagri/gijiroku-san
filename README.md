# 議事録さん ver 2.00

「**議事録さん**」は、Teamsのトランスクリプト（VTTファイル）をドラッグ＆ドロップで読み込み、役職に合わせた会議議事録を自動生成するための HTML/JavaScript アプリケーションです。  
コピー後は、対話型AI サイトをscripts.js内のwindow.open("ここにお好みの生成AIのURL", "_blank");を設定してください。
設定したサイトが自動的に起動し、すぐにプロンプトとトランスクリプト内容を連携できます。

![議事録さんの画面イメージ](image.png)

画面上部には議事録出力パラメータ（詳細度・決定事項・課題事項・問題事項・役職など）の設定エリア、下部にはVTTファイルのドロップゾーンが配置されています。  
ドラッグ＆ドロップでTeamsのトランスクリプト（VTTファイル）を追加し、「**クリップボードにコピー ＋ AIに連携**」ボタンを押すことで、テキスト抽出と AI サイトへの連携を一括で行えます。

---

## 構成ファイル

1. **gijiroku-san.html**  
   - アプリケーションのメイン画面（HTML）。テキストエリアやドキュメントのドロップゾーンを配置しています。  
   - Bootstrap でレイアウトを簡易的に整えています。  
   - スタイルシート (`styles.css`) とスクリプト (`scripts.js`) を読み込み、機能を実現します。

2. **scripts.js**  
   - ドラッグ＆ドロップで受け取ったVTTファイルの読み込み・テキスト抽出処理をまとめた JavaScript。  
   - Teamsのトランスクリプト（VTTファイル）を解析し、指定されたパラメータに基づいて議事録生成用のプロンプトを作成します。  
   - 抽出したテキストをまとめてクリップボードにコピーし、対話型AI サイトを自動的に別タブで開きます。  
   - **[Ver 2.00]** 議事詳細度、決定事項、課題事項、問題事項、役職など複数のパラメータを組み合わせて最適な議事録を生成するプロンプトを作成します。

3. **styles.css**  
   - 全体の配色やレイアウトなど、見た目を調整するための CSS。  
   - 背景色やスクロールバーの色などをカスタマイズしています。

---

## 使い方

1. **ファイルを配置する**  
   `gijiroku-san.html`, `scripts.js`, `styles.css` を同一フォルダ内に配置してください。  
   （または同等のパス構成になるように配置してください）

2. **ブラウザで `gijiroku-san.html` を開く**  
   - Chrome や Edge などのモダンブラウザを推奨します。  
   - ローカルのダブルクリックでも基本的には動作しますが、PDF・Word 抽出などで CORS エラーが出る場合があります。  
   - エラーが出る場合は、簡易ローカルサーバー（例: `npm install -g http-server`）を立ち上げ、`http://localhost:8080` などからアクセスすると安定します。

3. **プロンプトを入力**  
   - 画面左側の「プロンプト:」欄に、AI に投げたい指示や質問などを入力してください。  

4. **トランスクリプトのドラッグ＆ドロップ**  
   - 画面下部の「VTTファイルをドラッグ＆ドロップで追加」エリアに、Teamsのトランスクリプト(VTTファイル)をドラッグ＆ドロップすると、ファイルが読み込み候補に追加されます。

5. **内容をコピーして AI に連携**  
   - 「**クリップボードにコピー ＋ AIに連携**」ボタンを押すと、テキストエリアとドラッグ＆ドロップしたファイルの中身をすべてテキスト化・連結し、クリップボードへコピーします。  
   - コピーが完了すると、自動的に [https://v2.scsk-gai.jp/c/new](https://v2.scsk-gai.jp/c/new)（デフォルト設定）を新しいタブで開きます。  
   - AI サイト上の入力欄で貼り付け（Ctrl+V / Cmd+V）すると、抽出結果＋プロンプトがすぐに利用できます。  
   - なお、コピー内容の末尾には自動で  
     ```
     以上がインプット情報です。冒頭の指示に従ってください。
     ```  
     といった文言が付与されます。

6. **クリア**  
   - 「**クリア**」ボタンを押すと、入力したプロンプトやドロップしたファイル情報がすべてリセットされます。

---

## 主な機能

- **VTTファイル解析機能**  
  - Teamsの会議からエクスポートしたトランスクリプト(`.vtt`)ファイルを解析  
  - 発言者と発言内容を抽出して構造化  

- **柔軟な議事録パラメータ設定**  
  - 議事詳細度：  
    * 全文（発言者・タイムスタンプを保持）
    * 要約（議題ごとに見出し付きで要約）
    * 要点のみ（重要キーワードを箇条書き）
  - 決定事項：いる・いらないの選択可能  
  - 課題事項：いる・いらないの選択可能  
  - 問題事項：いる・いらないの選択可能  
  - 議事録を活用する役職：  
    * 指定なし（役職に関する説明なし）
    * 経営陣（戦略的意義・意思決定ポイントを強調）
    * 部課長（組織への影響とリソース配分を重視）
    * PLクラス（タスク進行と依存関係を詳細記載）
    * メンバー（担当タスクと次アクションを明確化）
    * 顧客（専門用語を避け、ビジネス価値を重視）
  - 自由入力：特定の情報に焦点を当てるための追加指示

- **自動プロンプト生成機能**  
  - 選択したパラメータに基づいて最適な議事録生成プロンプトを自動作成  
  - トランスクリプトと組み合わせて完全なAI入力を生成  
  - コピー完了後、AI サイトを自動で開くため、素早くプロンプトを利用できます。

- **議事録監査機能**  
  - 監査項目：  
    * 会議の準備改善（議題逸脱や混乱点の検出）
    * ファシリテーター改善（議事進行や意見引き出しの評価）
    * 重要ポイント確認（見落とされた重要事項の検出）
    * 会議決定タスク明確化（アクションアイテムの明確さや割り当ての評価）
  - 監査結果は議事録の最後尾に追加され、具体的な改善点と提案が提示されます

- **簡易テンプレート読み込み**  
  - 右側の「フォルダを選択」からプロンプトテンプレートの集まるフォルダを指定すると一覧が表示され、ファイルをクリックするだけでテキスト領域に流し込めます。  
  - テンプレートファイルを `★★★★★` 区切りで作成すれば、プロンプト・説明・必要ドキュメントリストの 3 つの欄に自動反映されます。

---

## 使用ライブラリ

HTML 内部で、以下の外部ライブラリ（CDN）を使用しています。  
オフライン環境で使用する場合は、それぞれローカルに配置し `scripts.js` や `prompt-kun.html` でパス指定を行ってください。

- **[Bootstrap 4.3.1](https://getbootstrap.com/)**  
  UI/レイアウト用デザインフレームワーク  
- **[jQuery 3.3.1](https://jquery.com/)** / **[Popper.js 1.14.7](https://popper.js.org/)**  
  Bootstrapの機能に必要  
- **[encoding-japanese 2.0.0](https://github.com/polygonplanet/encoding.js/)**  
  文字コード判定用  
- **[jszip 3.10.1](https://stuk.github.io/jszip/)**  
  各種圧縮ファイル処理用  
- **[pako 2.1.0](https://github.com/nodeca/pako)**  
  圧縮データ解凍用  

---

## 動作上の注意

1. **VTTファイル形式について**  
   - このツールはTeamsからエクスポートしたVTT形式のトランスクリプトファイルに最適化されています。  
   - 他の会議システムからのVTTファイルでも動作する場合がありますが、形式によっては正しく解析できない可能性があります。

2. **トランスクリプトの容量制限**  
   - 非常に長時間の会議トランスクリプトの場合、AIサービスの入力制限を超える可能性があります。  
   - そのような場合は、VTTファイルを複数に分割するか、会議の一部だけを処理してください。

3. **発言者情報の取得精度**  
   - VTTファイル内の発言者タグ（`<v Speaker>...</v>`形式）から発言者情報を抽出しています。  
   - トランスクリプトの品質によっては、発言者の識別が完全でない場合があります。

---

## カスタマイズ方法

1. **コピー後に開くサイトの変更**  
   - `scripts.js` 内の `copyText()` 関数にある  
     ```js
     window.open("https://v2.scsk-gai.jp/c/new", "_blank");
     ```  
     をお好みの対話型AIサイトに書き換えてください。

2. **コピー内容（ヘッダー・フッター）の変更**  
   - 同じく `scripts.js` 内の `copyText()` 関数で、コピー結果に付与されるヘッダー／フッターを編集できます。  
   - デフォルトではヘッダーは空、フッターとして  
     ```
     以上がインプット情報です。冒頭の指示に従ってください。
     ```  
     が付与されます。

3. **スタイル変更**  
   - `styles.css` を編集することで、色やレイアウトなどを自由に変更できます。

4. **ファイルの読み込みロジックを拡張**  
   - Excel, Word, PDF, PowerPoint 以外の特殊ファイル形式を解析したい場合は、`scripts.js` 内で拡張子ごとの分岐を追加・編集し、対応するライブラリを導入するなどの改修を行ってください。



5. **置換ワードの追加方法**  
   - `scripts.js` を開きます。  
   - `copyText` 関数内の `replacements` 配列を見つけます。  
   - 以下の形式の要素を追記します：  
     ```js
     const replacements = [
         { before: "置換前ワード1", after: "置換後ワード1" },
         { before: "置換前ワード2", after: "置換後ワード2" },
         // ここに追加
         { before: "Foo", after: "Bar" }
     ];
     ```

---

## ライセンス

このプロジェクトはMITライセンスの下で提供されています。
