<!DOCTYPE html>
<html lang="en">
<head>
    <link
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        rel="stylesheet"
    />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>議事録さん ver 2.10</title>
    <link rel="stylesheet" href="./styles.css" />
</head>
<body>
    <div class="container-fluid">
        <!-- ヘッダータイトルを追加 -->
        <div class="row mb-3 mt-2">
            <div class="col-12 text-center">
                <h2 class="text-primary">議事録さん ver 2.00</h2>
                <p class="text-muted">役職に合わせた会議議事録を自動生成し、会議改善提案もできる！</p>
            </div>
        </div>
        
        <!-- README情報をアコーディオンで表示 -->
        <div class="row mb-3">
            <div class="col-12">
                <div class="accordion" id="readmeAccordion">
                    <div class="card">
                        <div class="card-header" id="headingReadme">
                            <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse" data-target="#collapseReadme" aria-expanded="false" aria-controls="collapseReadme">
                                    README情報 - 使い方と機能説明
                                </button>
                            </h2>
                        </div>
                        <div id="collapseReadme" class="collapse" aria-labelledby="headingReadme" data-parent="#readmeAccordion">
                            <div class="card-body">
                                <h4>議事録さん ver 2.10</h4>
                                <p>「<strong>議事録さん</strong>」は、Teamsのトランスクリプト（VTTファイル）と会議資料をドラッグ＆ドロップで読み込み、役職に合わせた会議議事録を自動生成するための HTML/JavaScript アプリケーションです。<br>
                                コピー後は、対話型AI サイトが自動的に起動し、すぐにプロンプトとトランスクリプト内容と会議資料を連携できます。</p>
                                
                                <h5>使い方</h5>
                                <ol>
                                    <li><strong>議事録出力パラメータを設定</strong><br>
                                    議事詳細度、決定事項、課題事項、問題事項、役職などを選択します。</li>
                                    <li><strong>トランスクリプトと会議資料のドラッグ＆ドロップ</strong><br>
                                    画面下部のドロップゾーンにTeamsのトランスクリプト(VTTファイル)と会議資料（Excel, Word, PDF, PowerPoint）をドロップします。</li>
                                    <li><strong>内容をコピーして AI に連携</strong><br>
                                    「クリップボードにコピー ＋ AIに連携」ボタンを押して処理を実行します。</li>
                                </ol>
                                
                                <h5>主な機能</h5>
                                <ul>
                                    <li><strong>VTTファイル解析機能</strong><br>
                                    Teamsの会議からエクスポートしたトランスクリプトファイルを解析します。</li>
                                    <li><strong>会議資料処理機能（新機能）</strong><br>
                                    Excel、Word、PDF、PowerPointファイルからテキスト、セルデータ、コメント等を抽出し、トランスクリプトと組み合わせてより正確な議事録を生成します。</li>
                                    <li><strong>柔軟な議事録パラメータ設定</strong><br>
                                    議事詳細度、決定事項、課題事項、問題事項を設定し、読み手の役職（経営陣・部課長など）に合わせて内容を最適化できます。</li>
                                    <li><strong>自動プロンプト生成機能</strong><br>
                                    選択したパラメータに基づいて最適な議事録生成プロンプトを自動作成します。</li>
                                    <li><strong>議事録監査機能</strong><br>
                                    会議の準備改善、ファシリテーター改善、重要ポイント確認、会議決定タスク明確化の観点から議事録を監査し、改善点を提案します。</li>
                                </ul>
                                
                                <h5>動作上の注意</h5>
                                <ul>
                                    <li>このツールはTeamsからエクスポートしたVTT形式のトランスクリプトファイルに最適化されています。</li>
                                    <li>会議資料はオプションですが、アップロードすることでより詳細な議事録を生成できます。</li>
                                    <li>非常に長時間の会議トランスクリプトや大量の会議資料の場合、AIサービスの入力制限を超える可能性があります。</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-12">
                <div id="file-content" class="p-3 border">
                    <div id="selected-file" class="p-1 font-weight-bold"></div>
                    <div class="mb-2">
                        <div id="description" class="p-2 small"></div>
                    </div>

                    <!-- 議事録出力パラメータ -->
                    <div class="parameters-container border p-3 mb-3">
                      <h5>議事録出力パラメータ</h5>
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label">議事:</label>
                        <div class="col-sm-8">
                          <select class="form-control" id="param-gijiroku">
                            <option value="full">全文（発言者・タイムスタンプを保持）</option>
                            <option value="summary" selected>要約（議題ごとに見出し付きで要約）</option>
                            <option value="points">要点のみ（重要キーワードを箇条書き）</option>
                          </select>
                        </div>
                      </div>
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label">決定事項:</label>
                        <div class="col-sm-8">
                          <select class="form-control" id="param-decisions">
                            <option value="yes" selected>いる</option>
                            <option value="no">いらない</option>
                          </select>
                        </div>
                      </div>
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label">課題事項:</label>
                        <div class="col-sm-8">
                          <select class="form-control" id="param-tasks">
                            <option value="yes" selected>いる</option>
                            <option value="no">いらない</option>
                          </select>
                        </div>
                      </div>
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label">問題事項:</label>
                        <div class="col-sm-8">
                          <select class="form-control" id="param-issues">
                            <option value="yes" selected>いる</option>
                            <option value="no">いらない</option>
                          </select>
                        </div>
                      </div>
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label">議事録を活用する役職:</label>
                        <div class="col-sm-8">
                          <select class="form-control" id="param-position">
                            <option value="none" selected>指定なし（役職に関する説明なし）</option>
                            <option value="executive">経営陣（戦略的意義・意思決定ポイントを強調）</option>
                            <option value="manager">部課長（組織への影響とリソース配分を重視）</option>
                            <option value="pl">PLクラス（タスク進行と依存関係を詳細記載）</option>
                            <option value="member">メンバー（担当タスクと次アクションを明確化）</option>
                            <option value="customer">顧客（専門用語を避け、ビジネス価値を重視）</option>
                          </select>
                          <small class="form-text text-muted">※議事録を読む予定の役職に合わせて内容が最適化されます。</small>
                        </div>
                      </div>
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label">自由入力:</label>
                        <div class="col-sm-8">
                          <input type="text" class="form-control" id="param-custom" placeholder="議事録で知りたい事を100文字以内で" maxlength="100">
                        </div>
                      </div>

                      <!-- 議事録監査機能チェックボックス -->
                      <div class="form-group row">
                        <label class="col-sm-4 col-form-label">議事録監査:</label>
                        <div class="col-sm-8">
                          <small class="form-text text-muted mb-2">※会議を改善するためのアドバイス機能</small>
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="audit-preparation" value="1">
                            <label class="form-check-label" for="audit-preparation">1. 会議の準備改善</label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="audit-facilitator" value="2">
                            <label class="form-check-label" for="audit-facilitator">2. ファシリテーター改善</label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="audit-important-points" value="3">
                            <label class="form-check-label" for="audit-important-points">3. 重要ポイント確認改善</label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="audit-action-items" value="4">
                            <label class="form-check-label" for="audit-action-items">4. 会議決定タスク明確化改善</label>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="mb-2">
                        <label for="input-files" class="font-weight-bold">
                            必要なドキュメント (VTT) + 会議資料（Excel, Word, PowerPoint, PDF): <br>
                        </label>
                        <div class="alert alert-danger" role="alert">
                            <small>※Teamsのトランスクリプト(.vtt)ファイルをアップロードしてください。加えて、会議資料（Excel, Word, PowerPoint, PDF）もアップロード可能です。複数のファイルをアップロードすることも可能です。</small>
                        </div>

                        <div id="input-files" class="p-2 small"></div>
                        <div class="alert alert-warning" role="alert">
                            <small>※VTTファイルが大量の場合や長い会議の場合は、AIの文字数制限に注意してください。</small>
                        </div>
                    </div>
                    <div
                        id="drop-zone"
                        ondrop="dropHandler(event)"
                        ondragover="dragOverHandler(event)"
                        class="mt-3"
                    >
                    VTTファイル + 会議資料（Excel, Word, PowerPoint, PDF）をドラッグ＆ドロップで追加
                    </div>
                    <div id="dropped-files" class="mt-3"></div>
                    <button onclick="copyToClipboard()" class="btn btn-primary mr-2">
                        クリップボードにコピー ＋ AIに連携
                    </button>
                    <button onclick="clearAll()" class="btn btn-secondary mr-2">クリア</button>
                    <span class="text-primary ml-2" style="display: inline-block; margin-top: 10px;">GAIが開いたらプロンプトにペーストしてください</span>
                </div>
            </div>
        </div>
        
        <!-- フッター情報 -->
        <div class="row mt-3">
            <div class="col-12 text-center">
                <p class="small text-muted">議事録さん ver 2.00 - オーダーメイド議事録生成ツール</p>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS, Popper.js, and jQuery -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <!-- encoding JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/encoding-japanese/2.0.0/encoding.min.js"></script>

    <!-- ▼▼▼ ここから追加ライブラリ (Excel, PDF, Word対応) ▼▼▼ -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"
    ></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"
    ></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.5.1/mammoth.browser.min.js"
    ></script>
    <!-- ★★★ Wordの図形抽出に必要なJSZipを追加 ★★★ -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"
    ></script>
    <!-- ▲▲▲ 追加ライブラリここまで ▲▲▲ -->
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako_inflate.min.js"
    ></script>
    <script src="./scripts.js"></script>
</body>
</html>
